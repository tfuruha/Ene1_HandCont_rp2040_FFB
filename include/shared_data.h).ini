#ifndef SHARED_DATA_H
#define SHARED_DATA_H

#include <Arduino.h>

// Flashに保存する設定値
struct DeviceConfig {
    uint16_t main_gain;    // 全体のFFB強度
    float damper_gain;     // ダンパー係数
    float friction_gain;   // フリクション係数
    // 車両モデルに合わせた独自パラメータ
    float tire_grip_scale; 
};

// コア間でリアルタイムにやり取りするデータ
struct SharedControlData {
    // Core 0 (USB) -> Core 1 (Motor)
    volatile int16_t target_torque; // PCから届いたFFB合算トルク
    
    // Core 1 (Motor) -> Core 0 (USB)
    volatile int32_t current_angle;  // モーターから届いた現在の舵角
    volatile uint16_t pedal_accel;   // アクセル開度
    volatile uint16_t pedal_brake;   // ブレーキ踏力
};

extern DeviceConfig global_config;
extern SharedControlData shared_data;

#endif